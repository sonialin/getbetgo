<br />

<h1><%= @user.name %></h1>
<% if @user.title %>
	<p><%= @user.title %></p>
<% end %>

<h3>Avatar</h3>
<% if @user.avatar %>
	<%= image_tag @user.avatar.url(:medium) %>
<% end %>

<h1 class="decoration text-center proj"><span class="nobgr"><%= @user.name %>'s Funds</span></h1>

<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1">

      <div id="posts-container-user">
        <div class="row text-center" id="user-posts">
          <% @posts.each do |post| %>
            <%= content_tag(:div, :class => "portfolio-listing all") do %>
              <%= render :partial => "posts/post", :locals => {:post => post} %>
            <% end %>
          <% end %>
        </div> 
        <% if @posts.next_page %>
          <div id="with-button">
      			<%= will_paginate @posts %>
    			</div>

    			<div id="load_more_posts_user" class="btn btn-default btn-lg">More posts</div>
        <% end %>  
      </div>
  
    </div><!-- end coloum -->
  </div><!-- end row -->
</div><!-- container -->

<h3>Funded</h3>

<table>
<tbody>
<% @bets.each do |bet| %>
	<tr>
	<td><%= bet.post.title %></td>
	<td><%= bet.post.price %></td>
	</tr>
<% end %>
</tbody>
</table>

<% if @user == current_user %>
	<h3>Accounts</h3>
	<% @paypal_recipient_accounts.each do |account| %>
		<%= account.email %>
		<%= link_to 'Destroy', account, method: :delete, data: { confirm: 'Are you sure?' }, :class => 'btn btn-default' %>
	<% end %>

	<%= form_for @paypal_recipient_account, :url => { :controller => "paypal_recipient_accounts", :action => "create" }, :html => {:method => :post} do |f| %>
		<div class="form-group">
		  <%= f.text_area :email, :class => 'form-control' %><br />
		  <%= f.submit :class => "btn btn-primary" %>
		</div>
	<% end %>
<% end %>

<script>
  var $j = jQuery.noConflict();
  $j(function() { 
  	var loading_posts;
    if ($('#with-button').size() > 0) {
      $('#with-button .pagination').hide();
      loading_posts = false;
      $('#load_more_posts_user').show().click(function() {
        var $this, more_posts_url;
        if (!loading_posts) {
          loading_posts = true;
          more_posts_url = $j('#with-button .next_page').attr('href');
          if (more_posts_url) {
            $this = $(this);
            $this.html('<img src="/assets/ajax-loader.gif" alt="Loading..." title="Loading..." />').addClass('disabled');
            $.getScript(more_posts_url, function() {
              if ($this) {
                $this.text('More posts').removeClass('disabled');
              }
              return loading_posts = false;
            });
          }
         }
      });
    }
  });
</script>