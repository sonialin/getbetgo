<% if (!current_user && !params[:tag]) && !params[:location] %>
  <div class="jumbotron" id="home">
    <div class="container" id="home-content">
      <div class="row text-center">   
          <div class="col-md-10 col-md-offset-1" id="headline">
            <h1 >Throw In Whatever You'd Like</h1>
            <h3 id="subtitle">Integer commodo ipsum neque, nec elementum sem venenatis ac. Sed vehicula felis.</h3>
            <br />
            <%= link_to "#myModal", :data => {:toggle=>"modal"}, :class => "btn btn-danger btn-lg btn-start" do %>
              Start Now
            <% end %>    
          </div>
        </div>
    </div>
  </div>
<% end %>

<% if current_user %>
  <div class="container" id="add-post">
    <div class="col-md-10 col-md-offset-1">
      <div class="row">
        <div class="col-md-4 col-lg-2 vcenter-button text-center">
          <%= link_to "Add Fund", new_post_path, :class => "btn btn-fw btn-lg vcenter-button-position" %>
        </div>
        <div class="col-md-8 col-lg-10 vcenter-text">
          <h4>Lorem ipsum dolor sit amet, vidisse abhorreant nec no, at vim legimus deleniti, dicta volutpat mediocrem duo in.</h4>
          <p>Lorem ipsum dolor sit amet, vidisse abhorreant nec no, at vim legimus deleniti, dicta volutpat mediocrem duo in.</p>
        </div>
      </div>
    </div>
  </div>
<% end %>

<h1 class="decoration text-center proj"><span class="nobgr">Funds Available</span></h1>

<div class="container">
  <div class="row">
    <div class="col-md-10 col-md-offset-1">

      <% if params[:tag] %>
        <div id="filter-display" class="tag-display">
          <span class="search-text">Search results of tag:</span>
          <span class="search-tag">
            <a class="location-tag-filter">
              <i class="fa fa-times dismiss-tag"></i>
            </a>&nbsp;
            <%= params[:tag] %>
          </span>
        </div>
      <% elsif params[:location] %>
        <div id="filter-display" class="tag-display">
          <span class="search-text">Search results of location:</span>
          <span class="search-tag">
            <a class="location-tag-filter">
              <i class="fa fa-times dismiss-tag"></i>
            </a>&nbsp;
            <%= params[:location] %>
          </span>
        </div>
      <% else %>
        <%= render 'categories' %>
      <% end %>

      <div id="category-loader">
        <img src="/assets/ajax-loader.gif" alt="Loading..." title="Loading..." />&nbsp;&nbsp;Please wait while we are fetching posts
      </div>

      <%= render 'postscontainer' , :user_posts => false, :url_to_get_posts => "/getposts", :category => @category %>
  
    </div><!-- end coloum -->
  </div><!-- end row -->
</div><!-- container -->

<script>
  tag = "<%= @tag %>";
  locationn = "<%= @location %>";

  $(document).on('click', '#portfolio-filter .btn', function() {
    $('#portfolio-filter .btn').removeClass('current');
    $('#portfolio-filter .btn').removeClass('active');
    $(this).addClass('current');
    $(this).removeClass('active');
    $('#my-posts').html('');
    $('#load_more_posts').hide();
    $('#category-loader').show();

    category = $(this).attr('id');

    page = 1;

    $.ajax({
      url: '/getposts',
      type: 'POST',
      data: "category="+category+"&page="+page+"&tag="+tag+"&location="+locationn+"&type=1&offset=0",
      beforeSend: function(xhr, settings) {
        xhr.setRequestHeader('accept', '*/*;q=0.5, ' + settings.accepts.script);
      },
      success: function() {
        $('#category-loader').hide();
        window.history.pushState({},'', "/category/"+category);
      }
    });
  });

  $('#posts-container .user-info').popover({trigger: 'hover'});

  $('.location-tag-filter').click(function() {
    tag = "";
    locationn = "";
    $('#filter-display').hide();
    $('#my-posts').html('');
    $('#load_more_posts').hide();
    $('#category-loader').show();

    $.ajax({
      url: '/getposts',
      type: 'POST',
      data: "category=all&tag=&location=&type=1&offset=0&filterclose=1",
      beforeSend: function(xhr, settings) {
        xhr.setRequestHeader('accept', '*/*;q=0.5, ' + settings.accepts.script);
      },
      success: function() {
        $('#category-loader').hide();
        window.history.pushState({},'', "/category/all");
      }
    });
  });
</script>